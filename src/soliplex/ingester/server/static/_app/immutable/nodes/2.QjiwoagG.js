import{a as W,P as A}from"../chunks/CcgKWVoU.js";import{R as c}from"../chunks/DhxlaAyh.js";import{f as h,a as u}from"../chunks/j3K8jUZk.js";import{p as N,a as S,c as v,s as d,r as m,f as T}from"../chunks/Dj7rAsuq.js";import{i as b}from"../chunks/C64RYOYL.js";import{S as w}from"../chunks/vwGl9hoh.js";import{W as M}from"../chunks/OEI59-WQ.js";import{E as P}from"../chunks/KofPBhdr.js";const C=async()=>{try{const[n,t]=await Promise.all([W.getBatches(),W.getWorkflowRuns()]),r=new Date,f=new Date(r.getTime()-10080*60*1e3),k=n.filter(e=>new Date(e.start_date)>=f),a={pending:t.filter(e=>e.status===c.PENDING).length,running:t.filter(e=>e.status===c.RUNNING).length,completed:t.filter(e=>e.status===c.COMPLETED).length,error:t.filter(e=>e.status===c.ERROR).length,failed:t.filter(e=>e.status===c.FAILED).length},p=new Date(r.getFullYear(),r.getMonth(),r.getDate()),o=t.filter(e=>e.status===c.COMPLETED&&new Date(e.completed_date||"")>=p).length,s=a.completed,i=t.length,g=i>0?Math.round(s/i*100):0;return{metrics:{totalBatches:n.length,recentBatches:k.length,activeWorkflows:a.running+a.pending,pendingWorkflows:a.pending,runningWorkflows:a.running,failedWorkflows:a.failed+a.error,completedToday:o,successRate:g},recentActivity:t.slice(0,10)}}catch(n){return console.error("Failed to load dashboard data:",n),{metrics:{totalBatches:0,recentBatches:0,activeWorkflows:0,pendingWorkflows:0,runningWorkflows:0,failedWorkflows:0,completedToday:0,successRate:0},recentActivity:[],error:n}}},J=Object.freeze(Object.defineProperty({__proto__:null,load:C},Symbol.toStringTag,{value:"Module"}));var F=h('<div class="mt-6"><!></div>'),I=h('<div class="rounded-lg bg-white p-8 text-center text-gray-500 shadow"><p>No workflow activity yet</p></div>'),L=h('<div class="mt-6 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4"><!> <!> <!> <!></div> <div class="mt-8"><div class="mb-4 flex items-center justify-between"><h2 class="text-lg font-semibold text-gray-900">Recent Activity</h2> <a href="/workflows" class="text-sm font-medium text-blue-600 hover:text-blue-700">View all workflows â†’</a></div> <!></div>',1),O=h('<div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"><!> <!></div>');function K(n,t){N(t,!0);var r=O(),f=v(r);A(f,{title:"Dashboard",description:"Monitor your document processing workflows and batches"});var k=d(f,2);{var a=o=>{var s=F(),i=v(s);P(i,{get error(){return t.data.error}}),m(s),u(o,s)},p=o=>{var s=L(),i=T(s),g=v(i);w(g,{title:"Total Batches",get value(){return t.data.metrics.totalBatches},get description(){return`${t.data.metrics.recentBatches??""} added this week`},icon:"ðŸ“¦",href:"/batches"});var e=d(g,2);w(e,{title:"Active Workflows",get value(){return t.data.metrics.activeWorkflows},get description(){return`${t.data.metrics.runningWorkflows??""} running, ${t.data.metrics.pendingWorkflows??""} pending`},icon:"âš™ï¸",href:"/workflows?status=RUNNING"});var _=d(e,2);w(_,{title:"Failed Workflows",get value(){return t.data.metrics.failedWorkflows},description:"Requires attention",icon:"âš ï¸",href:"/workflows?status=FAILED"});var x=d(_,2);w(x,{title:"Success Rate",get value(){return`${t.data.metrics.successRate??""}%`},get description(){return`${t.data.metrics.completedToday??""} completed today`},icon:"âœ“"}),m(i);var y=d(i,2),R=d(v(y),2);{var D=l=>{var E=I();u(l,E)},B=l=>{M(l,{get workflows(){return t.data.recentActivity}})};b(R,l=>{t.data.recentActivity.length===0?l(D):l(B,!1)})}m(y),u(o,s)};b(k,o=>{t.data.error?o(a):o(p,!1)})}m(r),u(n,r),S()}export{K as component,J as universal};
