import{a as Mt,P as jt}from"../chunks/B4QU8YnM.js";import{e as Ot}from"../chunks/CBbuBPfZ.js";import{d as Ct,f as m,s as v,a as _,t as It,c as Bt}from"../chunks/DRP4mRRp.js";import{p as Nt,as as Ft,x as Gt,c as a,g as d,r as t,s as e,t as p,u as q,a as Pt,y as Ht,f as Wt}from"../chunks/pasavVN_.js";import{i as y}from"../chunks/B7f9mVOY.js";import{e as Ut,s as At}from"../chunks/CCxkpujE.js";import{S as Lt}from"../chunks/CnkkU-xV.js";import{s as St}from"../chunks/CSxf4DY1.js";import{R as E,L as x}from"../chunks/BOsosYgm.js";import{T as dt}from"../chunks/DQJyJeco.js";import{c as Tt,a as Jt,t as zt}from"../chunks/Or1p4CJ_.js";const qt=async({params:rt})=>{try{const s=parseInt(rt.id);if(isNaN(s))throw Ot(400,"Invalid workflow ID");const[g,st]=await Promise.all([Mt.getWorkflowRunDetails(s),Mt.getWorkflowLifecycleHistory(s)]);return{workflow:g,lifecycleHistory:st}}catch(s){throw console.error("Failed to load workflow:",s),Ot(404,"Workflow not found")}},Ra=Object.freeze(Object.defineProperty({__proto__:null,load:qt},Symbol.toStringTag,{value:"Module"}));var Kt=m('<div><dt class="font-medium text-gray-700">Worker</dt> <dd class="mt-1 text-gray-900"> </dd></div>'),Qt=m('<div class="mt-3"><dt class="font-medium text-gray-700">Status Message</dt> <dd class="mt-1 text-gray-900"> </dd></div>'),Vt=m('<div class="mt-3"><dt class="font-medium text-gray-700">Metadata</dt> <dd class="mt-1"><pre class="overflow-x-auto rounded bg-gray-100 p-2 text-xs text-gray-900"> </pre></dd></div>'),Xt=m('<div class="border-t border-gray-200 bg-gray-50 px-4 py-3"><dl class="grid grid-cols-1 gap-3 text-sm sm:grid-cols-2"><div><dt class="font-medium text-gray-700">Status</dt> <dd class="mt-1 text-gray-900"> </dd></div> <div><dt class="font-medium text-gray-700">Started</dt> <dd class="mt-1"><!></dd></div> <div><dt class="font-medium text-gray-700">Completed</dt> <dd class="mt-1"><!></dd></div> <div><dt class="font-medium text-gray-700">Duration</dt> <dd class="mt-1 text-gray-900"> </dd></div> <div><dt class="font-medium text-gray-700">Retries</dt> <dd class="mt-1 text-gray-900"> </dd></div> <!></dl> <!> <!></div>'),Yt=m('<div class="rounded-lg border border-gray-200 bg-white"><button type="button" class="w-full px-4 py-3 text-left hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"><div class="flex items-center gap-3"><span aria-hidden="true"> </span> <div class="flex-1"><div class="flex items-center gap-2"><span class="font-medium text-gray-900"> </span> <!></div> <div class="mt-1 text-xs text-gray-500"> <!></div></div> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!></div>'),Zt=m('<div class="space-y-2"></div>');function $t(rt,s){Nt(s,!0);let g=Ft(Gt(new Set));function st(f){d(g).has(f)?d(g).delete(f):d(g).add(f),Ht(g,new Set(d(g)),!0)}function xt(f){switch(f){case E.COMPLETED:return"✓";case E.RUNNING:return"⟳";case E.PENDING:return"⏸";case E.ERROR:return"⚠";case E.FAILED:return"✗";default:return"•"}}function yt(f){switch(f){case E.COMPLETED:return"text-green-600";case E.RUNNING:return"text-blue-600 animate-pulse";case E.PENDING:return"text-gray-400";case E.ERROR:return"text-orange-600";case E.FAILED:return"text-red-600";default:return"text-gray-500"}}const it=q(()=>[...s.steps].sort((f,o)=>f.workflow_step_number-o.workflow_step_number));var K=Zt();Ut(K,21,()=>d(it),f=>f.id,(f,o)=>{var B=Yt(),i=a(B);i.__click=()=>st(d(o).id);var r=a(i),T=a(r),A=a(T,!0);t(T);var Q=e(T,2),W=a(Q),V=a(W),X=a(V);t(V);var vt=e(V,2);Lt(vt,{get status(){return d(o).status},compact:!0}),t(W);var J=e(W,2),z=a(J),mt=e(z);{var ot=R=>{var C=It();p(I=>v(C,`• Duration: ${I??""}`),[()=>Tt(d(o).duration)]),_(R,C)};y(mt,R=>{d(o).duration!==null&&R(ot)})}t(J),t(Q);var wt=e(Q,2);t(r),t(i);var Y=e(i,2);{var nt=R=>{var C=Xt(),I=a(C),Z=a(I),ct=e(a(Z),2),w=a(ct,!0);t(ct),t(Z);var b=e(Z,2),N=e(a(b),2),P=a(N);dt(P,{get date(){return d(o).start_date}}),t(N),t(b);var L=e(b,2),F=e(a(L),2),G=a(F);dt(G,{get date(){return d(o).completed_date}}),t(F),t(L);var U=e(L,2),gt=e(a(U),2),$=a(gt,!0);t(gt),t(U);var tt=e(U,2),at=e(a(tt),2),et=a(at);t(at),t(tt);var ft=e(tt,2);{var lt=h=>{var D=Kt(),M=e(a(D),2),j=a(M,!0);t(M),t(D),p(()=>v(j,d(o).worker_id)),_(h,D)};y(ft,h=>{d(o).worker_id&&h(lt)})}t(I);var _t=e(I,2);{var ht=h=>{var D=Qt(),M=e(a(D),2),j=a(M,!0);t(M),t(D),p(()=>v(j,d(o).status_message)),_(h,D)};y(_t,h=>{d(o).status_message&&h(ht)})}var ut=e(_t,2);{var pt=h=>{var D=Vt(),M=e(a(D),2),j=a(M),bt=a(j,!0);t(j),t(M),t(D),p(kt=>v(bt,kt),[()=>JSON.stringify(d(o).status_meta,null,2)]),_(h,D)};y(ut,h=>{Object.keys(d(o).status_meta).length>0&&h(pt)})}t(C),p(h=>{v(w,d(o).status),v($,h),v(et,`${d(o).retry??""}/${d(o).retries??""}`)},[()=>Tt(d(o).duration)]),_(R,C)};y(Y,R=>{d(g).has(d(o).id)&&R(nt)})}t(B),p((R,C,I)=>{St(T,1,`text-lg ${R??""}`),v(A,C),v(X,`${d(o).workflow_step_number??""}. ${d(o).workflow_step_name??""}`),v(z,`Type: ${d(o).step_type??""} `),St(wt,0,`h-5 w-5 text-gray-400 transition-transform ${I??""}`)},[()=>yt(d(o).status),()=>xt(d(o).status),()=>d(g).has(d(o).id)?"rotate-180":""]),_(f,B)}),t(K),_(rt,K),Pt()}Ct(["click"]);var ta=m('<div><dt class="font-medium text-gray-700">Handler Name</dt> <dd class="mt-1 text-gray-900"> </dd></div>'),aa=m('<div><dt class="font-medium text-gray-700">Step ID</dt> <dd class="mt-1 text-gray-900"> </dd></div>'),ea=m('<div><dt class="font-medium text-gray-700">Status Updated</dt> <dd class="mt-1"><!></dd></div>'),da=m('<div><dt class="font-medium text-gray-700">Duration</dt> <dd class="mt-1 text-gray-900"> </dd></div>'),ra=m('<div class="mt-3"><dt class="font-medium text-gray-700">Status Message</dt> <dd class="mt-1 text-gray-900"> </dd></div>'),sa=m('<div class="mt-3"><dt class="font-medium text-gray-700">Metadata</dt> <dd class="mt-1"><pre class="overflow-x-auto rounded bg-gray-100 p-2 text-xs text-gray-900"> </pre></dd></div>'),ia=m('<div class="border-t border-gray-200 bg-gray-50 px-4 py-3"><dl class="grid grid-cols-1 gap-3 text-sm sm:grid-cols-2"><div><dt class="font-medium text-gray-700">Event Type</dt> <dd class="mt-1 text-gray-900"> </dd></div> <div><dt class="font-medium text-gray-700">Status</dt> <dd class="mt-1 text-gray-900"> </dd></div> <!> <div><dt class="font-medium text-gray-700">Started</dt> <dd class="mt-1"><!></dd></div> <div><dt class="font-medium text-gray-700">Completed</dt> <dd class="mt-1"><!></dd></div> <!> <div><dt class="font-medium text-gray-700">Run Group ID</dt> <dd class="mt-1 text-gray-900"> </dd></div> <!> <!></dl> <!> <!></div>'),va=m('<div><button type="button" class="w-full px-4 py-3 text-left hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"><div class="flex items-center gap-3"><span aria-hidden="true"> </span> <div class="flex-1"><div class="flex items-center gap-2"><span class="font-medium text-gray-900"> <!></span> <!></div> <div class="mt-1 text-xs text-gray-500"> <!></div></div> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!></div>'),oa=m('<div class="space-y-2"></div>');function na(rt,s){Nt(s,!0);let g=Ft(Gt(new Set));function st(i){d(g).has(i)?d(g).delete(i):d(g).add(i),Ht(g,new Set(d(g)),!0)}function xt(i){return{[x.GROUP_START]:"Run Group Started",[x.GROUP_END]:"Run Group Completed",[x.ITEM_START]:"Item Processing Started",[x.ITEM_END]:"Item Processing Completed",[x.ITEM_FAILED]:"Item Processing Failed",[x.STEP_START]:"Step Started",[x.STEP_END]:"Step Completed",[x.STEP_FAILED]:"Step Failed"}[i]||i}function yt(i){switch(i){case x.GROUP_START:case x.ITEM_START:case x.STEP_START:return"▶";case x.GROUP_END:case x.ITEM_END:case x.STEP_END:return"✓";case x.ITEM_FAILED:case x.STEP_FAILED:return"✗";default:return"•"}}function it(i,r){return i===x.ITEM_FAILED||i===x.STEP_FAILED||r===E.FAILED||r===E.ERROR?"text-red-600":r===E.COMPLETED?"text-green-600":r===E.RUNNING?"text-blue-600":"text-gray-600"}function K(i,r){return i===x.ITEM_FAILED||i===x.STEP_FAILED||r===E.FAILED||r===E.ERROR?"border-red-300":r===E.COMPLETED?"border-green-300":r===E.RUNNING?"border-blue-300":"border-gray-300"}function f(i){if(!i.start_date||!i.completed_date)return null;const r=new Date(i.start_date).getTime();return(new Date(i.completed_date).getTime()-r)/1e3}const o=q(()=>[...s.history].sort((i,r)=>{const T=new Date(i.start_date).getTime(),A=new Date(r.start_date).getTime();return T-A}));var B=oa();Ut(B,21,()=>d(o),i=>i.id,(i,r)=>{var T=va(),A=a(T);A.__click=()=>st(d(r).id);var Q=a(A),W=a(Q),V=a(W);t(W);var X=e(W,2),vt=a(X),J=a(vt),z=a(J),mt=e(z);{var ot=w=>{var b=It();p(()=>v(b,`-
									${d(r).handler_name??""}`)),_(w,b)};y(mt,w=>{d(r).handler_name&&w(ot)})}t(J);var wt=e(J,2);Lt(wt,{get status(){return d(r).status},compact:!0}),t(vt);var Y=e(vt,2),nt=a(Y),R=e(nt);{var C=w=>{const b=q(()=>f(d(r)));var N=Bt(),P=Wt(N);{var L=F=>{var G=It();p(U=>v(G,`• Duration: ${U??""}`),[()=>Tt(d(b))]),_(F,G)};y(P,F=>{d(b)!==null&&F(L)})}_(w,N)};y(R,w=>{d(r).completed_date&&w(C)})}t(Y),t(X);var I=e(X,2);t(Q),t(A);var Z=e(A,2);{var ct=w=>{var b=ia(),N=a(b),P=a(N),L=e(a(P),2),F=a(L,!0);t(L),t(P);var G=e(P,2),U=e(a(G),2),gt=a(U,!0);t(U),t(G);var $=e(G,2);{var tt=u=>{var c=ta(),k=e(a(c),2),O=a(k,!0);t(k),t(c),p(()=>v(O,d(r).handler_name)),_(u,c)};y($,u=>{d(r).handler_name&&u(tt)})}var at=e($,2),et=e(a(at),2),ft=a(et);dt(ft,{get date(){return d(r).start_date}}),t(et),t(at);var lt=e(at,2),_t=e(a(lt),2),ht=a(_t);dt(ht,{get date(){return d(r).completed_date}}),t(_t),t(lt);var ut=e(lt,2);{var pt=u=>{var c=aa(),k=e(a(c),2),O=a(k,!0);t(k),t(c),p(()=>v(O,d(r).step_id)),_(u,c)};y(ut,u=>{d(r).step_id&&u(pt)})}var h=e(ut,2),D=e(a(h),2),M=a(D,!0);t(D),t(h);var j=e(h,2);{var bt=u=>{var c=ea(),k=e(a(c),2),O=a(k);dt(O,{get date(){return d(r).status_date}}),t(k),t(c),_(u,c)};y(j,u=>{d(r).status_date&&u(bt)})}var kt=e(j,2);{var n=u=>{const c=q(()=>f(d(r)));var k=da(),O=e(a(k),2),Dt=a(O,!0);t(O),t(k),p(Rt=>v(Dt,Rt),[()=>Tt(d(c))]),_(u,k)};y(kt,u=>{f(d(r))!==null&&u(n)})}t(N);var l=e(N,2);{var S=u=>{var c=ra(),k=e(a(c),2),O=a(k,!0);t(k),t(c),p(()=>v(O,d(r).status_message)),_(u,c)};y(l,u=>{d(r).status_message&&u(S)})}var H=e(l,2);{var Et=u=>{var c=sa(),k=e(a(c),2),O=a(k),Dt=a(O,!0);t(O),t(k),t(c),p(Rt=>v(Dt,Rt),[()=>JSON.stringify(d(r).status_meta,null,2)]),_(u,c)};y(H,u=>{Object.keys(d(r).status_meta).length>0&&u(Et)})}t(b),p(()=>{v(F,d(r).event),v(gt,d(r).status),v(M,d(r).run_group_id)}),_(w,b)};y(Z,w=>{d(g).has(d(r).id)&&w(ct)})}t(T),p((w,b,N,P,L,F)=>{St(T,1,`rounded-lg border ${w??""} bg-white`),St(W,1,`text-lg ${b??""}`),v(V,`${N??""}-`),v(z,`${P??""} `),v(nt,`${L??""} `),St(I,0,`h-5 w-5 text-gray-400 transition-transform ${F??""}`)},[()=>K(d(r).event,d(r).status),()=>it(d(r).event,d(r).status),()=>yt(d(r).event),()=>xt(d(r).event),()=>Jt(d(r).start_date),()=>d(g).has(d(r).id)?"rotate-180":""]),_(i,T)}),t(B),_(rt,B),Pt()}Ct(["click"]);var la=m('<a href="/workflows" class="text-sm font-medium text-gray-600 hover:text-gray-900">← Back to workflows</a>'),_a=m('<div><dt class="text-sm font-medium text-gray-500">Progress</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div>'),ua=m('<div class="mt-6 rounded-md bg-gray-50 p-4"><h3 class="text-sm font-medium text-gray-700">Status Message</h3> <p class="mt-1 text-sm text-gray-900"> </p></div>'),ma=m('<div class="mt-6 rounded-md bg-gray-50 p-4"><h3 class="text-sm font-medium text-gray-700">Status Metadata</h3> <pre class="mt-2 overflow-x-auto text-xs text-gray-900"> </pre></div>'),ca=m('<div class="mt-8"><h2 class="mb-4 text-lg font-semibold text-gray-900">Workflow Steps</h2> <!></div>'),ga=m('<div class="mt-8"><h2 class="mb-4 text-lg font-semibold text-gray-900">Lifecycle History</h2> <div class="overflow-hidden rounded-lg bg-white shadow"><div class="px-6 py-5"><!></div></div></div>'),fa=m('<div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"><!> <div class="mt-6"><div class="overflow-hidden rounded-lg bg-white shadow"><div class="px-6 py-5"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center gap-3"><h2 class="text-xl font-semibold text-gray-900"> </h2> <!></div> <p class="mt-2 text-sm text-gray-600">Document: <span class="font-mono text-xs"> </span></p></div></div> <div class="mt-6 grid grid-cols-1 gap-6 border-t border-gray-200 pt-6 sm:grid-cols-2 lg:grid-cols-3"><div><dt class="text-sm font-medium text-gray-500">Definition</dt> <dd class="mt-1 text-sm text-gray-900"><a class="text-blue-600 hover:text-blue-700"> </a></dd></div> <div><dt class="text-sm font-medium text-gray-500">Batch</dt> <dd class="mt-1 text-sm text-gray-900"><a class="text-blue-600 hover:text-blue-700"> </a></dd></div> <div><dt class="text-sm font-medium text-gray-500">Run Group</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Priority</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Created</dt> <dd class="mt-1 text-sm"><!></dd></div> <div><dt class="text-sm font-medium text-gray-500">Started</dt> <dd class="mt-1 text-sm"><!></dd></div> <div><dt class="text-sm font-medium text-gray-500">Completed</dt> <dd class="mt-1 text-sm"><!></dd></div> <div><dt class="text-sm font-medium text-gray-500">Duration</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div> <!></div> <!> <!></div></div> <!> <!></div></div>');function Ia(rt,s){Nt(s,!0);const g=q(()=>s.data.workflow.steps&&s.data.workflow.steps.length>0),st=q(()=>{var n;return((n=s.data.workflow.steps)==null?void 0:n.filter(l=>l.status==="COMPLETED").length)||0}),xt=q(()=>{var n;return((n=s.data.workflow.steps)==null?void 0:n.length)||0}),yt=q(()=>s.data.lifecycleHistory&&s.data.lifecycleHistory.length>0);var it=fa(),K=a(it);jt(K,{get title(){return`Workflow Run #${s.data.workflow.id??""}`},actions:l=>{var S=la();_(l,S)}});var f=e(K,2),o=a(f),B=a(o),i=a(B),r=a(i),T=a(r),A=a(T),Q=a(A);t(A);var W=e(A,2);Lt(W,{get status(){return s.data.workflow.status}}),t(T);var V=e(T,2),X=e(a(V)),vt=a(X,!0);t(X),t(V),t(r),t(i);var J=e(i,2),z=a(J),mt=e(a(z),2),ot=a(mt),wt=a(ot,!0);t(ot),t(mt),t(z);var Y=e(z,2),nt=e(a(Y),2),R=a(nt),C=a(R);t(R),t(nt),t(Y);var I=e(Y,2),Z=e(a(I),2),ct=a(Z);t(Z),t(I);var w=e(I,2),b=e(a(w),2),N=a(b,!0);t(b),t(w);var P=e(w,2),L=e(a(P),2),F=a(L);dt(F,{get date(){return s.data.workflow.created_date}}),t(L),t(P);var G=e(P,2),U=e(a(G),2),gt=a(U);dt(gt,{get date(){return s.data.workflow.start_date}}),t(U),t(G);var $=e(G,2),tt=e(a($),2),at=a(tt);dt(at,{get date(){return s.data.workflow.completed_date}}),t(tt),t($);var et=e($,2),ft=e(a(et),2),lt=a(ft,!0);t(ft),t(et);var _t=e(et,2);{var ht=n=>{var l=_a(),S=e(a(l),2),H=a(S);t(S),t(l),p(()=>v(H,`${d(st)??""}/${d(xt)??""} steps`)),_(n,l)};y(_t,n=>{d(g)&&n(ht)})}t(J);var ut=e(J,2);{var pt=n=>{var l=ua(),S=e(a(l),2),H=a(S,!0);t(S),t(l),p(()=>v(H,s.data.workflow.status_message)),_(n,l)};y(ut,n=>{s.data.workflow.status_message&&n(pt)})}var h=e(ut,2);{var D=n=>{var l=ma(),S=e(a(l),2),H=a(S,!0);t(S),t(l),p(Et=>v(H,Et),[()=>JSON.stringify(s.data.workflow.status_meta,null,2)]),_(n,l)};y(h,n=>{Object.keys(s.data.workflow.status_meta).length>0&&n(D)})}t(B),t(o);var M=e(o,2);{var j=n=>{var l=ca(),S=e(a(l),2);{let H=q(()=>s.data.workflow.steps||[]);$t(S,{get steps(){return d(H)}})}t(l),_(n,l)};y(M,n=>{d(g)&&n(j)})}var bt=e(M,2);{var kt=n=>{var l=ga(),S=e(a(l),2),H=a(S),Et=a(H);na(Et,{get history(){return s.data.lifecycleHistory}}),t(H),t(S),t(l),_(n,l)};y(bt,n=>{d(yt)&&n(kt)})}t(f),t(it),p((n,l)=>{v(Q,`Workflow #${s.data.workflow.id??""}`),v(vt,n),At(ot,"href",`/definitions/workflows/${s.data.workflow.workflow_definition_id??""}`),v(wt,s.data.workflow.workflow_definition_id),At(R,"href",`/batches/${s.data.workflow.batch_id??""}`),v(C,`#${s.data.workflow.batch_id??""}`),v(ct,`#${s.data.workflow.run_group_id??""}`),v(N,s.data.workflow.priority),v(lt,l)},[()=>zt(s.data.workflow.doc_id,60),()=>Tt(s.data.workflow.duration)]),_(rt,it),Pt()}export{Ia as component,Ra as universal};
