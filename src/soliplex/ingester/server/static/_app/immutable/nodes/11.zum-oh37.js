import{a as St,P as Dt}from"../chunks/BOAlGdYI.js";import{e as wt}from"../chunks/CBbuBPfZ.js";import{d as Nt,f,s as i,a as c,t as Rt}from"../chunks/j3K8jUZk.js";import{p as ht,b as Et,D as Ot,c as a,g as r,r as t,s as e,t as h,u as X,a as bt,d as Pt}from"../chunks/Dj7rAsuq.js";import{i as p}from"../chunks/C64RYOYL.js";import{s as yt}from"../chunks/nNctCYpw.js";import{S as pt}from"../chunks/D8p6h-Bw.js";import{e as Ct}from"../chunks/CoFdoVSq.js";import{s as kt}from"../chunks/C2Md6CUa.js";import{R as k}from"../chunks/DhxlaAyh.js";import{a as gt,b as Y,t as It}from"../chunks/CR8k5L1G.js";const Mt=async({params:G})=>{try{const d=parseInt(G.id);if(isNaN(d))throw wt(400,"Invalid workflow ID");return{workflow:await St.getWorkflowRunDetails(d)}}catch(d){throw console.error("Failed to load workflow:",d),wt(404,"Workflow not found")}},da=Object.freeze(Object.defineProperty({__proto__:null,load:Mt},Symbol.toStringTag,{value:"Module"}));var Tt=f('<div><dt class="font-medium text-gray-700">Worker</dt> <dd class="mt-1 text-gray-900"> </dd></div>'),jt=f('<div class="mt-3"><dt class="font-medium text-gray-700">Status Message</dt> <dd class="mt-1 text-gray-900"> </dd></div>'),Wt=f('<div class="mt-3"><dt class="font-medium text-gray-700">Metadata</dt> <dd class="mt-1"><pre class="overflow-x-auto rounded bg-gray-100 p-2 text-xs text-gray-900"> </pre></dd></div>'),Gt=f('<div class="border-t border-gray-200 bg-gray-50 px-4 py-3"><dl class="grid grid-cols-1 gap-3 text-sm sm:grid-cols-2"><div><dt class="font-medium text-gray-700">Status</dt> <dd class="mt-1 text-gray-900"> </dd></div> <div><dt class="font-medium text-gray-700">Started</dt> <dd class="mt-1 text-gray-900"> </dd></div> <div><dt class="font-medium text-gray-700">Completed</dt> <dd class="mt-1 text-gray-900"> </dd></div> <div><dt class="font-medium text-gray-700">Duration</dt> <dd class="mt-1 text-gray-900"> </dd></div> <div><dt class="font-medium text-gray-700">Retries</dt> <dd class="mt-1 text-gray-900"> </dd></div> <!></dl> <!> <!></div>'),Lt=f('<div class="rounded-lg border border-gray-200 bg-white"><button type="button" class="w-full px-4 py-3 text-left hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"><div class="flex items-center gap-3"><span aria-hidden="true"> </span> <div class="flex-1"><div class="flex items-center gap-2"><span class="font-medium text-gray-900"> </span> <!></div> <div class="mt-1 text-xs text-gray-500"> <!></div></div> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!></div>'),Bt=f('<div class="space-y-2"></div>');function Ft(G,d){ht(d,!0);let g=Et(Ot(new Set));function it(l){r(g).has(l)?r(g).delete(l):r(g).add(l),Pt(g,new Set(r(g)),!0)}function vt(l){switch(l){case k.COMPLETED:return"✓";case k.RUNNING:return"⟳";case k.PENDING:return"⏸";case k.ERROR:return"⚠";case k.FAILED:return"✗";default:return"•"}}function L(l){switch(l){case k.COMPLETED:return"text-green-600";case k.RUNNING:return"text-blue-600 animate-pulse";case k.PENDING:return"text-gray-400";case k.ERROR:return"text-orange-600";case k.FAILED:return"text-red-600";default:return"text-gray-500"}}const Z=X(()=>[...d.steps].sort((l,o)=>l.workflow_step_number-o.workflow_step_number));var R=Bt();Ct(R,21,()=>r(Z),l=>l.id,(l,o)=>{var D=Lt(),N=a(D);N.__click=()=>it(r(o).id);var E=a(N),S=a(E),lt=a(S,!0);t(S);var B=e(S,2),O=a(B),P=a(O),nt=a(P);t(P);var F=e(P,2);pt(F,{get status(){return r(o).status},compact:!0}),t(O);var C=e(O,2),A=a(C),J=e(A);{var mt=w=>{var _=Rt();h(y=>i(_,`• Duration: ${y??""}`),[()=>gt(r(o).duration)]),c(w,_)};p(J,w=>{r(o).duration!==null&&w(mt)})}t(C),t(B);var U=e(B,2);t(E),t(N);var $=e(N,2);{var z=w=>{var _=Gt(),y=a(_),H=a(y),I=e(a(H),2),tt=a(I,!0);t(I),t(H);var q=e(H,2),M=e(a(q),2),at=a(M,!0);t(M),t(q);var K=e(q,2),T=e(a(K),2),et=a(T,!0);t(T),t(K);var Q=e(K,2),j=e(a(Q),2),rt=a(j,!0);t(j),t(Q);var V=e(Q,2),W=e(a(V),2),dt=a(W);t(W),t(V);var ut=e(V,2);{var ct=m=>{var u=Tt(),x=e(a(u),2),s=a(x,!0);t(x),t(u),h(()=>i(s,r(o).worker_id)),c(m,u)};p(ut,m=>{r(o).worker_id&&m(ct)})}t(y);var st=e(y,2);{var ot=m=>{var u=jt(),x=e(a(u),2),s=a(x,!0);t(x),t(u),h(()=>i(s,r(o).status_message)),c(m,u)};p(st,m=>{r(o).status_message&&m(ot)})}var _t=e(st,2);{var xt=m=>{var u=Wt(),x=e(a(u),2),s=a(x),v=a(s,!0);t(s),t(x),t(u),h(n=>i(v,n),[()=>JSON.stringify(r(o).status_meta,null,2)]),c(m,u)};p(_t,m=>{Object.keys(r(o).status_meta).length>0&&m(xt)})}t(_),h((m,u,x)=>{i(tt,r(o).status),i(at,m),i(et,u),i(rt,x),i(dt,`${r(o).retry??""}/${r(o).retries??""}`)},[()=>Y(r(o).start_date),()=>Y(r(o).completed_date),()=>gt(r(o).duration)]),c(w,_)};p($,w=>{r(g).has(r(o).id)&&w(z)})}t(D),h((w,_,y)=>{kt(S,1,`text-lg ${w??""}`),i(lt,_),i(nt,`${r(o).workflow_step_number??""}. ${r(o).workflow_step_name??""}`),i(A,`Type: ${r(o).step_type??""} `),kt(U,0,`h-5 w-5 text-gray-400 transition-transform ${y??""}`)},[()=>L(r(o).status),()=>vt(r(o).status),()=>r(g).has(r(o).id)?"rotate-180":""]),c(l,D)}),t(R),c(G,R),bt()}Nt(["click"]);var At=f('<a href="/workflows" class="text-sm font-medium text-gray-600 hover:text-gray-900">← Back to workflows</a>'),Jt=f('<div><dt class="text-sm font-medium text-gray-500">Progress</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div>'),Ut=f('<div class="mt-6 rounded-md bg-gray-50 p-4"><h3 class="text-sm font-medium text-gray-700">Status Message</h3> <p class="mt-1 text-sm text-gray-900"> </p></div>'),zt=f('<div class="mt-6 rounded-md bg-gray-50 p-4"><h3 class="text-sm font-medium text-gray-700">Status Metadata</h3> <pre class="mt-2 overflow-x-auto text-xs text-gray-900"> </pre></div>'),Ht=f('<div class="mt-8"><h2 class="mb-4 text-lg font-semibold text-gray-900">Workflow Steps</h2> <!></div>'),qt=f('<div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"><!> <div class="mt-6"><div class="overflow-hidden rounded-lg bg-white shadow"><div class="px-6 py-5"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center gap-3"><h2 class="text-xl font-semibold text-gray-900"> </h2> <!></div> <p class="mt-2 text-sm text-gray-600">Document: <span class="font-mono text-xs"> </span></p></div></div> <div class="mt-6 grid grid-cols-1 gap-6 border-t border-gray-200 pt-6 sm:grid-cols-2 lg:grid-cols-3"><div><dt class="text-sm font-medium text-gray-500">Definition</dt> <dd class="mt-1 text-sm text-gray-900"><a class="text-blue-600 hover:text-blue-700"> </a></dd></div> <div><dt class="text-sm font-medium text-gray-500">Batch</dt> <dd class="mt-1 text-sm text-gray-900"><a class="text-blue-600 hover:text-blue-700"> </a></dd></div> <div><dt class="text-sm font-medium text-gray-500">Run Group</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Priority</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Created</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Started</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Completed</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Duration</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div> <!></div> <!> <!></div></div> <!></div></div>');function sa(G,d){ht(d,!0);const g=X(()=>d.data.workflow.steps&&d.data.workflow.steps.length>0),it=X(()=>{var s;return((s=d.data.workflow.steps)==null?void 0:s.filter(v=>v.status==="COMPLETED").length)||0}),vt=X(()=>{var s;return((s=d.data.workflow.steps)==null?void 0:s.length)||0});var L=qt(),Z=a(L);Dt(Z,{get title(){return`Workflow Run #${d.data.workflow.id??""}`},actions:v=>{var n=At();c(v,n)}});var R=e(Z,2),l=a(R),o=a(l),D=a(o),N=a(D),E=a(N),S=a(E),lt=a(S);t(S);var B=e(S,2);pt(B,{get status(){return d.data.workflow.status}}),t(E);var O=e(E,2),P=e(a(O)),nt=a(P,!0);t(P),t(O),t(N),t(D);var F=e(D,2),C=a(F),A=e(a(C),2),J=a(A),mt=a(J,!0);t(J),t(A),t(C);var U=e(C,2),$=e(a(U),2),z=a($),w=a(z);t(z),t($),t(U);var _=e(U,2),y=e(a(_),2),H=a(y);t(y),t(_);var I=e(_,2),tt=e(a(I),2),q=a(tt,!0);t(tt),t(I);var M=e(I,2),at=e(a(M),2),K=a(at,!0);t(at),t(M);var T=e(M,2),et=e(a(T),2),Q=a(et,!0);t(et),t(T);var j=e(T,2),rt=e(a(j),2),V=a(rt,!0);t(rt),t(j);var W=e(j,2),dt=e(a(W),2),ut=a(dt,!0);t(dt),t(W);var ct=e(W,2);{var st=s=>{var v=Jt(),n=e(a(v),2),b=a(n);t(n),t(v),h(()=>i(b,`${r(it)??""}/${r(vt)??""} steps`)),c(s,v)};p(ct,s=>{r(g)&&s(st)})}t(F);var ot=e(F,2);{var _t=s=>{var v=Ut(),n=e(a(v),2),b=a(n,!0);t(n),t(v),h(()=>i(b,d.data.workflow.status_message)),c(s,v)};p(ot,s=>{d.data.workflow.status_message&&s(_t)})}var xt=e(ot,2);{var m=s=>{var v=zt(),n=e(a(v),2),b=a(n,!0);t(n),t(v),h(ft=>i(b,ft),[()=>JSON.stringify(d.data.workflow.status_meta,null,2)]),c(s,v)};p(xt,s=>{Object.keys(d.data.workflow.status_meta).length>0&&s(m)})}t(o),t(l);var u=e(l,2);{var x=s=>{var v=Ht(),n=e(a(v),2);{let b=X(()=>d.data.workflow.steps||[]);Ft(n,{get steps(){return r(b)}})}t(v),c(s,v)};p(u,s=>{r(g)&&s(x)})}t(R),t(L),h((s,v,n,b,ft)=>{i(lt,`Workflow #${d.data.workflow.id??""}`),i(nt,s),yt(J,"href",`/definitions/workflows/${d.data.workflow.workflow_definition_id??""}`),i(mt,d.data.workflow.workflow_definition_id),yt(z,"href",`/batches/${d.data.workflow.batch_id??""}`),i(w,`#${d.data.workflow.batch_id??""}`),i(H,`#${d.data.workflow.run_group_id??""}`),i(q,d.data.workflow.priority),i(K,v),i(Q,n),i(V,b),i(ut,ft)},[()=>It(d.data.workflow.doc_id,60),()=>Y(d.data.workflow.created_date),()=>Y(d.data.workflow.start_date),()=>Y(d.data.workflow.completed_date),()=>gt(d.data.workflow.duration)]),c(G,L),bt()}export{sa as component,da as universal};
