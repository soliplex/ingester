import{a as V,P as Zt}from"../chunks/DntY5q7d.js";import{e as Gt}from"../chunks/CBbuBPfZ.js";import{f as g,a as _,s as p,e as $t}from"../chunks/j3K8jUZk.js";import{l as ta,ax as aa,y as ea,ay as ra,T as sa,m as U,o as oa,c as t,s as r,r as a,t as E,p as zt,g as l,a as Ut,n as Tt,b as L,d as h,f as da,u as At}from"../chunks/Dj7rAsuq.js";import{i as F}from"../chunks/C64RYOYL.js";import{b as ft}from"../chunks/mtVfkGY5.js";import{W as la}from"../chunks/Dhngr7aD.js";import{S as H}from"../chunks/CTtfyeyz.js";import{e as Bt,i as Mt}from"../chunks/CoFdoVSq.js";import{r as ia}from"../chunks/nNctCYpw.js";import{s as na}from"../chunks/C2Md6CUa.js";import{p as va}from"../chunks/Bx2u9gNR.js";import{T as jt}from"../chunks/CBvU0fPL.js";import{R as f}from"../chunks/BOsosYgm.js";import{c as ua}from"../chunks/Or1p4CJ_.js";import{i as ca}from"../chunks/vzmStAmi.js";function ma(s,e,v=e){var b=new WeakSet;ta(s,"input",async u=>{var i=u?s.defaultValue:s.value;if(i=ct(s)?mt(i):i,v(i),U!==null&&b.add(U),await aa(),i!==(i=e())){var y=s.selectionStart,x=s.selectionEnd,k=s.value.length;if(s.value=i??"",x!==null){var m=s.value.length;y===x&&x===k&&m>k?(s.selectionStart=m,s.selectionEnd=m):(s.selectionStart=y,s.selectionEnd=Math.min(x,m))}}}),(sa&&s.defaultValue!==s.value||ea(e)==null&&s.value)&&(v(ct(s)?mt(s.value):s.value),U!==null&&b.add(U)),ra(()=>{var u=e();if(s===document.activeElement){var i=oa??U;if(b.has(i))return}ct(s)&&u===mt(s.value)||s.type==="date"&&!u&&!s.value||u!==s.value&&(s.value=u??"")})}function ct(s){var e=s.type;return e==="number"||e==="range"}function mt(s){return s===""?null:+s}var fa=g('<span class="text-sm text-gray-600"> </span>'),_a=g('<div class="flex items-center justify-center gap-2"><div role="status" aria-label="Loading"></div> <!></div>');function ga(s,e){let v=va(e,"size",3,"md");const b={sm:"h-4 w-4 border-2",md:"h-8 w-8 border-3",lg:"h-12 w-12 border-4"};var u=_a(),i=t(u),y=r(i,2);{var x=k=>{var m=fa(),S=t(m,!0);a(m),E(()=>p(S,e.text)),_(k,m)};F(y,k=>{e.text&&k(x)})}a(u),E(()=>na(i,1,`animate-spin rounded-full border-blue-600 border-t-transparent ${b[v()]??""}`)),_(s,u)}const ba=async({params:s})=>{try{const e=parseInt(s.id);if(isNaN(e))throw Gt(400,"Invalid batch ID");const[v,b,u,i]=await Promise.all([V.getBatchStatus(e),V.getWorkflowRuns(e),V.getWorkflowDefinitions(),V.getParamSets()]);return{batchId:e,batch:v.batch,documentCount:v.document_count,workflowCounts:v.workflow_count,workflows:b,parsed:v.parsed,remaining:v.remaining,workflowDefinitions:u,paramSets:i}}catch(e){throw console.error("Failed to load batch:",e),Gt(404,"Batch not found")}},Ka=Object.freeze(Object.defineProperty({__proto__:null,load:ba},Symbol.toStringTag,{value:"Module"}));var xa=g("<option> </option>"),pa=g("<option> </option>"),ya=g('<div class="rounded-md bg-red-50 p-3" role="alert"><p class="text-sm text-red-800"> </p></div>'),wa=g('<div class="rounded-md bg-green-50 p-3" role="alert"><p class="text-sm text-green-800"> </p></div>'),ha=g("<!> <span>Starting...</span>",1),ka=g("<span>Start Workflows</span>"),Sa=g('<div class="rounded-lg border border-gray-200 bg-white p-6 shadow"><h3 class="text-lg font-semibold text-gray-900">Start Workflows</h3> <p class="mt-1 text-sm text-gray-600">Start workflow processing for all documents in this batch</p> <form class="mt-4 space-y-4"><div><label for="workflow" class="block text-sm font-medium text-gray-700">Workflow Definition</label> <select id="workflow" class="mt-1 block w-full rounded-md border-gray-300 py-2 pl-3 pr-10 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:bg-gray-100 disabled:text-gray-500"><option>Default (from config)</option><!></select></div> <div><label for="param-set" class="block text-sm font-medium text-gray-700">Parameter Set</label> <select id="param-set" class="mt-1 block w-full rounded-md border-gray-300 py-2 pl-3 pr-10 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:bg-gray-100 disabled:text-gray-500"><option>Default</option><!></select></div> <div><label for="priority" class="block text-sm font-medium text-gray-700">Priority</label> <input type="number" id="priority" min="0" max="100" class="mt-1 block w-full rounded-md border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:bg-gray-100 disabled:text-gray-500"/> <p class="mt-1 text-xs text-gray-500">Higher values = higher priority (default: 0)</p></div> <!> <!> <div class="flex justify-end"><button type="submit" class="inline-flex items-center gap-2 rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-400 disabled:cursor-not-allowed"><!></button></div></form></div>');function Da(s,e){zt(e,!0);let v=L(""),b=L("default"),u=L(0),i=L(!1),y=L(null),x=L(null);async function k(d){d.preventDefault(),h(i,!0),h(y,null),h(x,null);try{const o=await V.startWorkflows(e.batchId,l(v)||void 0,l(u),l(b)||void 0);h(x,`${o.message}: ${o.workflows} workflows started (Run Group: ${o.run_group})`),h(v,""),h(b,"default"),h(u,0),e.onSuccess&&setTimeout(e.onSuccess,1500)}catch(o){h(y,o instanceof Error?o.message:"Failed to start workflows",!0)}finally{h(i,!1)}}var m=Sa(),S=r(t(m),4),I=t(S),N=r(t(I),2),O=t(N);O.value=O.__value="";var Y=r(O);Bt(Y,17,()=>e.workflowDefinitions,Mt,(d,o)=>{var n=xa(),D=t(n);a(n);var P={};E(()=>{p(D,`${l(o).name??""} (${l(o).id??""})`),P!==(P=l(o).id)&&(n.value=(n.__value=l(o).id)??"")}),_(d,n)}),a(N),a(I);var R=r(I,2),C=r(t(R),2),A=t(C);A.value=A.__value="";var B=r(A);Bt(B,17,()=>e.paramSets,Mt,(d,o)=>{var n=pa(),D=t(n);a(n);var P={};E(()=>{p(D,`${l(o).name??""} (${l(o).id??""})`),P!==(P=l(o).id)&&(n.value=(n.__value=l(o).id)??"")}),_(d,n)}),a(C),a(R);var G=r(R,2),M=r(t(G),2);ia(M),Tt(2),a(G);var j=r(G,2);{var q=d=>{var o=ya(),n=t(o),D=t(n,!0);a(n),a(o),E(()=>p(D,l(y))),_(d,o)};F(j,d=>{l(y)&&d(q)})}var J=r(j,2);{var Z=d=>{var o=wa(),n=t(o),D=t(n,!0);a(n),a(o),E(()=>p(D,l(x))),_(d,o)};F(J,d=>{l(x)&&d(Z)})}var K=r(J,2),T=t(K),Q=t(T);{var z=d=>{var o=ha(),n=da(o);ga(n,{size:"sm"}),Tt(2),_(d,o)},X=d=>{var o=ka();_(d,o)};F(Q,d=>{l(i)?d(z):d(X,!1)})}a(T),a(K),a(S),a(m),E(()=>{N.disabled=l(i),C.disabled=l(i),M.disabled=l(i),T.disabled=l(i)}),$t("submit",S,k),ft(N,()=>l(v),d=>h(v,d)),ft(C,()=>l(b),d=>h(b,d)),ma(M,()=>l(u),d=>h(u,d)),_(s,m),Ut()}var Ea=g('<a href="/batches" class="text-sm font-medium text-gray-600 hover:text-gray-900">← Back to batches</a>'),Na=g('<span class="inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-sm font-medium text-green-800">✓ Complete</span>'),Ia=g('<span class="inline-flex items-center rounded-full bg-blue-100 px-3 py-1 text-sm font-medium text-blue-800">⟳ In Progress</span>'),Ra=g('<div><dt class="text-sm font-medium text-gray-500">Completed</dt> <dd class="mt-1 text-sm"><!></dd></div>'),Ca=g('<div><dt class="text-sm font-medium text-gray-500">Duration</dt> <dd class="mt-1 text-sm text-gray-900"> </dd></div>'),Pa=g('<div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"><!> <div class="mt-6"><div class="overflow-hidden rounded-lg bg-white shadow"><div class="px-6 py-5"><div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"><div><dt class="text-sm font-medium text-gray-500">Batch ID</dt> <dd class="mt-1 text-lg font-semibold text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Source</dt> <dd class="mt-1 text-lg font-semibold text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Documents</dt> <dd class="mt-1 text-lg font-semibold text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Status</dt> <dd class="mt-1"><!></dd></div></div> <div class="mt-6 border-t border-gray-200 pt-6"><div class="grid grid-cols-1 gap-6 sm:grid-cols-2"><div><dt class="text-sm font-medium text-gray-500">Started</dt> <dd class="mt-1 text-sm"><!></dd></div> <!> <!></div></div></div> <div class="border-t border-gray-200 bg-gray-50 px-6 py-4"><h3 class="text-sm font-medium text-gray-700">Workflow Status</h3> <div class="mt-3 flex flex-wrap gap-4"><div class="flex items-center gap-2"><!> <span class="text-sm text-gray-600"> </span></div> <div class="flex items-center gap-2"><!> <span class="text-sm text-gray-600"> </span></div> <div class="flex items-center gap-2"><!> <span class="text-sm text-gray-600"> </span></div> <div class="flex items-center gap-2"><!> <span class="text-sm text-gray-600"> </span></div> <div class="flex items-center gap-2"><!> <span class="text-sm text-gray-600"> </span></div></div></div></div> <div class="mt-8"><!></div> <div class="mt-8"><div class="mb-4 flex items-center justify-between"><h2 class="text-lg font-semibold text-gray-900">Workflows</h2> <div class="flex items-center gap-2"><label for="status-select" class="text-sm text-gray-600">Filter:</label> <select id="status-select" class="rounded-md border-gray-300 text-sm focus:border-blue-500 focus:ring-blue-500"><option>All</option><option>Pending</option><option>Running</option><option>Completed</option><option>Error</option><option>Failed</option></select></div></div> <!></div></div></div>');function Qa(s,e){zt(e,!0);let v=L("all");const b=At(()=>l(v)==="all"?e.data.workflows:e.data.workflows.filter(c=>c.status===l(v))),u=At(()=>e.data.batch.completed_date!==null);function i(){ca()}var y=Pa(),x=t(y);Zt(x,{get title(){return`Batch: ${e.data.batch.name??""}`},actions:w=>{var W=Ea();_(w,W)}});var k=r(x,2),m=t(k),S=t(m),I=t(S),N=t(I),O=r(t(N),2),Y=t(O);a(O),a(N);var R=r(N,2),C=r(t(R),2),A=t(C,!0);a(C),a(R);var B=r(R,2),G=r(t(B),2),M=t(G,!0);a(G),a(B);var j=r(B,2),q=r(t(j),2),J=t(q);{var Z=c=>{var w=Na();_(c,w)},K=c=>{var w=Ia();_(c,w)};F(J,c=>{l(u)?c(Z):c(K,!1)})}a(q),a(j),a(I);var T=r(I,2),Q=t(T),z=t(Q),X=r(t(z),2),d=t(X);jt(d,{get date(){return e.data.batch.start_date}}),a(X),a(z);var o=r(z,2);{var n=c=>{var w=Ra(),W=r(t(w),2),ut=t(W);jt(ut,{get date(){return e.data.batch.completed_date}}),a(W),a(w),_(c,w)};F(o,c=>{e.data.batch.completed_date&&c(n)})}var D=r(o,2);{var P=c=>{var w=Ca(),W=r(t(w),2),ut=t(W,!0);a(W),a(w),E(Yt=>p(ut,Yt),[()=>ua(e.data.batch.duration)]),_(c,w)};F(D,c=>{e.data.batch.duration!==null&&c(P)})}a(Q),a(T),a(S);var _t=r(S,2),gt=r(t(_t),2),$=t(gt),bt=t($);H(bt,{get status(){return f.COMPLETED}});var xt=r(bt,2),Ht=t(xt,!0);a(xt),a($);var tt=r($,2),pt=t(tt);H(pt,{get status(){return f.RUNNING}});var yt=r(pt,2),Vt=t(yt,!0);a(yt),a(tt);var at=r(tt,2),wt=t(at);H(wt,{get status(){return f.PENDING}});var ht=r(wt,2),qt=t(ht,!0);a(ht),a(at);var et=r(at,2),kt=t(et);H(kt,{get status(){return f.ERROR}});var St=r(kt,2),Jt=t(St,!0);a(St),a(et);var Dt=r(et,2),Et=t(Dt);H(Et,{get status(){return f.FAILED}});var Nt=r(Et,2),Kt=t(Nt,!0);a(Nt),a(Dt),a(gt),a(_t),a(m);var rt=r(m,2),Qt=t(rt);Da(Qt,{get batchId(){return e.data.batchId},get workflowDefinitions(){return e.data.workflowDefinitions},get paramSets(){return e.data.paramSets},onSuccess:i}),a(rt);var It=r(rt,2),st=t(It),Rt=r(t(st),2),ot=r(t(Rt),2),dt=t(ot);dt.value=dt.__value="all";var lt=r(dt),Ct={},it=r(lt),Pt={},nt=r(it),Wt={},vt=r(nt),Lt={},Ft=r(vt),Ot={};a(ot),a(Rt),a(st);var Xt=r(st,2);la(Xt,{get workflows(){return l(b)}}),a(It),a(k),a(y),E(()=>{p(Y,`#${e.data.batch.id??""}`),p(A,e.data.batch.source),p(M,e.data.documentCount),p(Ht,e.data.workflowCounts.COMPLETED||0),p(Vt,e.data.workflowCounts.RUNNING||0),p(qt,e.data.workflowCounts.PENDING||0),p(Jt,e.data.workflowCounts.ERROR||0),p(Kt,e.data.workflowCounts.FAILED||0),Ct!==(Ct=f.PENDING)&&(lt.value=(lt.__value=f.PENDING)??""),Pt!==(Pt=f.RUNNING)&&(it.value=(it.__value=f.RUNNING)??""),Wt!==(Wt=f.COMPLETED)&&(nt.value=(nt.__value=f.COMPLETED)??""),Lt!==(Lt=f.ERROR)&&(vt.value=(vt.__value=f.ERROR)??""),Ot!==(Ot=f.FAILED)&&(Ft.value=(Ft.__value=f.FAILED)??"")}),ft(ot,()=>l(v),c=>h(v,c)),_(s,y),Ut()}export{Qa as component,Ka as universal};
