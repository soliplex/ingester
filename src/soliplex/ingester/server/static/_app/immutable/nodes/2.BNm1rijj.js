import{a as W,P as E}from"../chunks/BOAlGdYI.js";import{R as d}from"../chunks/DhxlaAyh.js";import{f as k,a as u}from"../chunks/j3K8jUZk.js";import{p as N,a as S,c as v,s as f,r as w,f as T}from"../chunks/Dj7rAsuq.js";import{i as b}from"../chunks/C64RYOYL.js";import{S as h}from"../chunks/vwGl9hoh.js";import{W as M}from"../chunks/68cU5iJb.js";import{E as P}from"../chunks/CQHdeKum.js";const C=async()=>{try{const[i,t]=await Promise.all([W.getBatches(),W.getWorkflowRuns()]),r=Array.isArray(t)?t:t.items,n=new Date,p=new Date(n.getTime()-10080*60*1e3),_=i.filter(e=>new Date(e.start_date)>=p),a={pending:r.filter(e=>e.status===d.PENDING).length,running:r.filter(e=>e.status===d.RUNNING).length,completed:r.filter(e=>e.status===d.COMPLETED).length,error:r.filter(e=>e.status===d.ERROR).length,failed:r.filter(e=>e.status===d.FAILED).length},o=new Date(n.getFullYear(),n.getMonth(),n.getDate()),s=r.filter(e=>e.status===d.COMPLETED&&new Date(e.completed_date||"")>=o).length,l=a.completed,g=r.length,m=g>0?Math.round(l/g*100):0;return{metrics:{totalBatches:i.length,recentBatches:_.length,activeWorkflows:a.running+a.pending,pendingWorkflows:a.pending,runningWorkflows:a.running,failedWorkflows:a.failed+a.error,completedToday:s,successRate:m},recentActivity:r.slice(0,10)}}catch(i){return console.error("Failed to load dashboard data:",i),{metrics:{totalBatches:0,recentBatches:0,activeWorkflows:0,pendingWorkflows:0,runningWorkflows:0,failedWorkflows:0,completedToday:0,successRate:0},recentActivity:[],error:i}}},J=Object.freeze(Object.defineProperty({__proto__:null,load:C},Symbol.toStringTag,{value:"Module"}));var F=k('<div class="mt-6"><!></div>'),I=k('<div class="rounded-lg bg-white p-8 text-center text-gray-500 shadow"><p>No workflow activity yet</p></div>'),L=k('<div class="mt-6 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4"><!> <!> <!> <!></div> <div class="mt-8"><div class="mb-4 flex items-center justify-between"><h2 class="text-lg font-semibold text-gray-900">Recent Activity</h2> <a href="/workflows" class="text-sm font-medium text-blue-600 hover:text-blue-700">View all workflows â†’</a></div> <!></div>',1),O=k('<div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"><!> <!></div>');function K(i,t){N(t,!0);var r=O(),n=v(r);E(n,{title:"Dashboard",description:"Monitor your document processing workflows and batches"});var p=f(n,2);{var _=o=>{var s=F(),l=v(s);P(l,{get error(){return t.data.error}}),w(s),u(o,s)},a=o=>{var s=L(),l=T(s),g=v(l);h(g,{title:"Total Batches",get value(){return t.data.metrics.totalBatches},get description(){return`${t.data.metrics.recentBatches??""} added this week`},icon:"ðŸ“¦",href:"/batches"});var m=f(g,2);h(m,{title:"Active Workflows",get value(){return t.data.metrics.activeWorkflows},get description(){return`${t.data.metrics.runningWorkflows??""} running, ${t.data.metrics.pendingWorkflows??""} pending`},icon:"âš™ï¸",href:"/workflows?status=RUNNING"});var e=f(m,2);h(e,{title:"Failed Workflows",get value(){return t.data.metrics.failedWorkflows},description:"Requires attention",icon:"âš ï¸",href:"/workflows?status=FAILED"});var x=f(e,2);h(x,{title:"Success Rate",get value(){return`${t.data.metrics.successRate??""}%`},get description(){return`${t.data.metrics.completedToday??""} completed today`},icon:"âœ“"}),w(l);var y=f(l,2),R=f(v(y),2);{var D=c=>{var B=I();u(c,B)},A=c=>{M(c,{get workflows(){return t.data.recentActivity}})};b(R,c=>{t.data.recentActivity.length===0?c(D):c(A,!1)})}w(y),u(o,s)};b(p,o=>{t.data.error?o(_):o(a,!1)})}w(r),u(i,r),S()}export{K as component,J as universal};
