import{a as P,P as tt}from"../chunks/CiG-dbCb.js";import{R as h}from"../chunks/BOsosYgm.js";import{d as at,f as m,s as b,a as f}from"../chunks/B3CJz9bp.js";import{p as U,c as s,r,t as G,g as _,s as d,a as V,f as et,u as rt}from"../chunks/BrMMe1xa.js";import{i as B}from"../chunks/CWeRAD6a.js";import{S}from"../chunks/BOPdCmyn.js";import{e as T,i as I}from"../chunks/jBV541Un.js";import{s as st,c as ot}from"../chunks/B887dx_8.js";import{E as lt}from"../chunks/_GzF0giG.js";import{c as H,a as dt}from"../chunks/Or1p4CJ_.js";import{g as it}from"../chunks/DMA8kSn2.js";const nt=async()=>{try{const[u,e]=await Promise.all([P.getRunGroups(),P.getWorkflowRuns()]),p=u.slice(0,10),g=(await Promise.all(p.map(async a=>{try{const c=await P.getRunGroupStats(a.id);return{runGroup:a,stats:c}}catch{return null}}))).filter(a=>a!==null),i=e.length,n=e.filter(a=>a.status===h.COMPLETED).length,y=e.filter(a=>a.status===h.FAILED||a.status===h.ERROR).length,x=e.filter(a=>a.status===h.RUNNING).length,l=i>0?Math.round(n/i*100):0,t=e.filter(a=>a.status===h.COMPLETED&&a.duration!==null),o=t.length>0?t.reduce((a,c)=>a+(c.duration||0),0)/t.length:0;return{systemStats:{totalWorkflows:i,completedWorkflows:n,failedWorkflows:y,activeWorkflows:x,successRate:l,avgDuration:o},runGroupStats:g}}catch(u){return console.error("Failed to load statistics:",u),{systemStats:{totalWorkflows:0,completedWorkflows:0,failedWorkflows:0,activeWorkflows:0,successRate:0,avgDuration:0},runGroupStats:[],error:u}}},Et=Object.freeze(Object.defineProperty({__proto__:null,load:nt},Symbol.toStringTag,{value:"Module"}));var ct=m('<th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"> </th>'),ut=m('<td class="whitespace-nowrap px-6 py-4 text-sm text-gray-900"> </td>'),vt=m("<tr></tr>"),ft=m('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr></tr></thead><tbody class="divide-y divide-gray-200 bg-white"></tbody></table></div>');function mt(u,e){U(e,!0);function p(l){e.onRowClick&&e.onRowClick(l)}function k(l,t){return t.format?t.format(l):l==null?"â€”":String(l)}var g=ft(),i=s(g),n=s(i),y=s(n);T(y,21,()=>e.columns,I,(l,t)=>{var o=ct(),a=s(o,!0);r(o),G(()=>b(a,_(t).label)),f(l,o)}),r(y),r(n);var x=d(n);T(x,21,()=>e.data,I,(l,t)=>{var o=vt();o.__click=()=>p(_(t)),T(o,21,()=>e.columns,I,(a,c)=>{var w=ut(),R=s(w,!0);r(w),G(D=>b(R,D),[()=>k(_(t)[_(c).key],_(c))]),f(a,w)}),r(o),G(()=>st(o,1,ot(e.onRowClick?"cursor-pointer hover:bg-gray-50":""))),f(l,o)}),r(x),r(i),r(g),f(u,g),V()}at(["click"]);var gt=m('<div class="mt-6"><!></div>'),_t=m('<div class="px-6 py-12 text-center text-gray-500"><p>No run group data available</p></div>'),pt=m('<div class="mt-6 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4"><!> <!> <!> <!></div> <div class="mt-8"><div class="overflow-hidden rounded-lg bg-white shadow"><div class="px-6 py-5"><h3 class="text-lg font-semibold text-gray-900">Performance Metrics</h3> <div class="mt-4 grid grid-cols-1 gap-6 sm:grid-cols-3"><div><dt class="text-sm font-medium text-gray-500">Average Duration</dt> <dd class="mt-1 text-2xl font-semibold text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Active Workflows</dt> <dd class="mt-1 text-2xl font-semibold text-gray-900"> </dd></div> <div><dt class="text-sm font-medium text-gray-500">Total Run Groups</dt> <dd class="mt-1 text-2xl font-semibold text-gray-900"> </dd></div></div></div></div></div> <div class="mt-8"><div class="overflow-hidden rounded-lg bg-white shadow"><div class="border-b border-gray-200 px-6 py-4"><h3 class="text-lg font-semibold text-gray-900">Recent Run Groups</h3></div> <!></div></div>',1),yt=m('<div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"><!> <!></div>');function Pt(u,e){U(e,!0);const p=rt(()=>e.data.runGroupStats.map(t=>({runGroupId:t.runGroup.id,batchId:t.runGroup.batch_id,workflow:t.runGroup.workflow_definition_id,created:dt(t.runGroup.created_date),totalRuns:t.stats.total_runs,completed:t.stats.status_counts.COMPLETED||0,failed:(t.stats.status_counts.FAILED||0)+(t.stats.status_counts.ERROR||0),avgDuration:H(t.stats.avg_duration)}))),k=[{key:"runGroupId",label:"Run Group"},{key:"batchId",label:"Batch"},{key:"workflow",label:"Workflow"},{key:"created",label:"Created"},{key:"totalRuns",label:"Total Runs"},{key:"completed",label:"Completed"},{key:"failed",label:"Failed"},{key:"avgDuration",label:"Avg Duration"}];function g(t){it(`/batches/${t.batchId}`)}var i=yt(),n=s(i);tt(n,{title:"Statistics",description:"System-wide workflow and processing metrics"});var y=d(n,2);{var x=t=>{var o=gt(),a=s(o);lt(a,{get error(){return e.data.error}}),r(o),f(t,o)},l=t=>{var o=pt(),a=et(o),c=s(a);S(c,{title:"Total Workflows",get value(){return e.data.systemStats.totalWorkflows},icon:"âš™ï¸"});var w=d(c,2);S(w,{title:"Completed",get value(){return e.data.systemStats.completedWorkflows},description:"Successfully finished",icon:"âœ“"});var R=d(w,2);S(R,{title:"Failed",get value(){return e.data.systemStats.failedWorkflows},description:"Requires attention",icon:"âœ—"});var D=d(R,2);S(D,{title:"Success Rate",get value(){return`${e.data.systemStats.successRate??""}%`},icon:"ðŸ“Š"}),r(a);var W=d(a,2),M=s(W),O=s(M),L=d(s(O),2),C=s(L),A=d(s(C),2),J=s(A,!0);r(A),r(C);var E=d(C,2),F=d(s(E),2),K=s(F,!0);r(F),r(E);var N=d(E,2),j=d(s(N),2),Q=s(j,!0);r(j),r(N),r(L),r(O),r(M),r(W);var q=d(W,2),z=s(q),X=d(s(z),2);{var Y=v=>{var $=_t();f(v,$)},Z=v=>{mt(v,{get columns(){return k},get data(){return _(p)},onRowClick:g})};B(X,v=>{_(p).length===0?v(Y):v(Z,!1)})}r(z),r(q),G(v=>{b(J,v),b(K,e.data.systemStats.activeWorkflows),b(Q,e.data.runGroupStats.length)},[()=>H(e.data.systemStats.avgDuration)]),f(t,o)};B(y,t=>{e.data.error?t(x):t(l,!1)})}r(i),f(u,i),V()}export{Pt as component,Et as universal};
