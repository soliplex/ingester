import{a as b,P as E}from"../chunks/hTc4Iqh7.js";import{R as d}from"../chunks/BOsosYgm.js";import{p as N,c as p,x,h as m,j as S,k as h,l as f,r as k,d as T}from"../chunks/DCSobnyE.js";import{S as _}from"../chunks/ritJiAL8.js";import{W as M}from"../chunks/SwHyXTjJ.js";import{E as P}from"../chunks/DQ-Inkti.js";const I=async()=>{try{const[n,e]=await Promise.all([b.getBatches(),b.getWorkflowRuns(void 0,void 0,!0)]),a=Array.isArray(e)?e:e.items,o=t=>"workflow_run"in t?t.workflow_run:t,l=new Date,y=new Date(l.getTime()-10080*60*1e3),W=n.filter(t=>new Date(t.start_date)>=y),r={pending:a.filter(t=>o(t).status===d.PENDING).length,running:a.filter(t=>o(t).status===d.RUNNING).length,completed:a.filter(t=>o(t).status===d.COMPLETED).length,error:a.filter(t=>o(t).status===d.ERROR).length,failed:a.filter(t=>o(t).status===d.FAILED).length},s=new Date(l.getFullYear(),l.getMonth(),l.getDate()),i=a.filter(t=>{const u=o(t);return u.status===d.COMPLETED&&new Date(u.completed_date||"")>=s}).length,v=r.completed,g=a.length,w=g>0?Math.round(v/g*100):0;return{metrics:{totalBatches:n.length,recentBatches:W.length,activeWorkflows:r.running+r.pending,pendingWorkflows:r.pending,runningWorkflows:r.running,failedWorkflows:r.failed+r.error,completedToday:i,successRate:w},recentActivity:a.slice(0,10)}}catch(n){return console.error("Failed to load dashboard data:",n),{metrics:{totalBatches:0,recentBatches:0,activeWorkflows:0,pendingWorkflows:0,runningWorkflows:0,failedWorkflows:0,completedToday:0,successRate:0},recentActivity:[],error:n}}},V=Object.freeze(Object.defineProperty({__proto__:null,load:I},Symbol.toStringTag,{value:"Module"}));var C=p('<div class="mt-6"><!></div>'),F=p('<div class="rounded-lg bg-white p-8 text-center text-gray-500 shadow"><p>No workflow activity yet</p></div>'),L=p('<div class="mt-6 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4"><!> <!> <!> <!></div> <div class="mt-8"><div class="mb-4 flex items-center justify-between"><h2 class="text-lg font-semibold text-gray-900">Recent Activity</h2> <a href="/workflows" class="text-sm font-medium text-blue-600 hover:text-blue-700">View all workflows â†’</a></div> <!></div>',1),O=p('<div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"><!> <!></div>');function Y(n,e){N(e,!0);var a=O(),o=h(a);E(o,{title:"Dashboard",description:"Monitor your document processing workflows and batches"});var l=f(o,2);{var y=r=>{var s=C(),i=h(s);P(i,{get error(){return e.data.error}}),k(s),m(r,s)},W=r=>{var s=L(),i=T(s),v=h(i);_(v,{title:"Total Batches",get value(){return e.data.metrics.totalBatches},get description(){return`${e.data.metrics.recentBatches??""} added this week`},icon:"ðŸ“¦",href:"/batches"});var g=f(v,2);_(g,{title:"Active Workflows",get value(){return e.data.metrics.activeWorkflows},get description(){return`${e.data.metrics.runningWorkflows??""} running, ${e.data.metrics.pendingWorkflows??""} pending`},icon:"âš™ï¸",href:"/workflows?status=RUNNING"});var w=f(g,2);_(w,{title:"Failed Workflows",get value(){return e.data.metrics.failedWorkflows},description:"Requires attention",icon:"âš ï¸",href:"/workflows?status=FAILED"});var t=f(w,2);_(t,{title:"Success Rate",get value(){return`${e.data.metrics.successRate??""}%`},get description(){return`${e.data.metrics.completedToday??""} completed today`},icon:"âœ“"}),k(i);var u=f(i,2),R=f(h(u),2);{var D=c=>{var B=F();m(c,B)},A=c=>{M(c,{get workflows(){return e.data.recentActivity}})};x(R,c=>{e.data.recentActivity.length===0?c(D):c(A,!1)})}k(u),m(r,s)};x(l,r=>{e.data.error?r(y):r(W,!1)})}k(a),m(n,a),S()}export{Y as component,V as universal};
